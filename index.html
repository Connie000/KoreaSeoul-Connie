<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>È¶ñÁàæÊó•Ë®ò Pro+ 2026</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto+Sans+TC', sans-serif; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-[#FFFCF5]">
    <div id="app" class="h-screen w-full flex flex-col overflow-hidden select-none text-slate-700">
        
        <header class="pt-14 pb-4 px-6 bg-white/60 backdrop-blur-lg border-b border-orange-50 flex justify-between items-end shrink-0 z-40">
            <div>
                <h1 class="text-xl font-black tracking-tight flex items-center gap-2">È¶ñÁàæÊó•Ë®ò <span class="text-rose-300">üá∞üá∑</span></h1>
                <p class="text-[10px] font-bold text-slate-300 uppercase tracking-widest mt-0.5">May 2026 ‚Ä¢ Seoul Journey</p>
            </div>
            <button @click="activeTab = 'info'" class="p-2.5 bg-orange-50 text-orange-400 rounded-2xl active:scale-90"><i data-lucide="info" class="w-[18px]"></i></button>
        </header>

        <div class="flex-1 overflow-y-auto px-5 pt-4 pb-32 no-scrollbar">
            
            <div v-if="activeTab === 'itinerary'" class="space-y-4">
                <div class="flex gap-3 overflow-x-auto pb-2 no-scrollbar">
                    <button v-for="d in 5" :key="d" @click="activeDay = d"
                        :class="['flex-shrink-0 w-16 h-20 rounded-[1.8rem] flex flex-col items-center justify-center transition-all', 
                        activeDay === d ? 'bg-orange-100 text-orange-600 shadow-sm scale-105' : 'bg-white text-slate-300 border border-slate-50']">
                        <span class="text-[10px] font-black opacity-60">{{ getDayDetail(d).date }}</span>
                        <span class="text-lg font-black">{{ d }}</span>
                        <span class="text-[9px] font-bold opacity-60">{{ getDayDetail(d).week }}</span>
                    </button>
                </div>

                <div class="space-y-4">
                    <div v-for="(item, idx) in filteredItinerary" :key="item.id" class="bg-white p-5 rounded-[2.2rem] shadow-sm border border-orange-50 relative">
                        <div class="flex justify-between items-center mb-2">
                            <span class="flex items-center gap-1.5 text-[11px] font-black text-orange-300">
                                <i data-lucide="clock" class="w-3 h-3"></i> {{ item.time }}
                            </span>
                            <div class="flex items-center gap-1">
                                <button @click="openEdit(item)" class="p-1.5 text-slate-300 active:text-orange-400"><i data-lucide="edit-3" class="w-[15px]"></i></button>
                                <button @click="moveItem(item.id, 'up')" :disabled="idx === 0" :class="['p-1.5', idx === 0 ? 'text-slate-100' : 'text-slate-300']"><i data-lucide="chevron-up" class="w-[15px]"></i></button>
                                <button @click="moveItem(item.id, 'down')" :disabled="idx === filteredItinerary.length - 1" :class="['p-1.5', idx === filteredItinerary.length - 1 ? 'text-slate-100' : 'text-slate-300']"><i data-lucide="chevron-down" class="w-[15px]"></i></button>
                            </div>
                        </div>
                        <h3 class="text-base font-black text-slate-800 leading-tight">{{ item.title }}</h3>
                        <p class="text-[12px] text-blue-400 mt-1.5 mb-3 flex items-start gap-1 font-bold" @click="openGoogleMaps(item.addr)">
                            <i data-lucide="map-pin" class="w-3 h-3 mt-0.5"></i> {{ item.addr }}
                        </p>
                        <div v-if="item.note" class="bg-slate-50 p-3.5 rounded-2xl text-[11px] text-slate-400 leading-relaxed border border-slate-100/50 whitespace-pre-wrap">{{ item.note }}</div>
                        
                        <button @click="driverTarget = item" class="absolute bottom-4 right-4 bg-white border border-orange-100 text-orange-400 p-3 rounded-2xl shadow-sm"><i data-lucide="car" class="w-[18px]"></i></button>
                    </div>
                    <button @click="openAddModal('itinerary')" class="w-full py-5 bg-white border-2 border-dashed border-orange-100 rounded-[2.2rem] text-orange-200 font-black text-xs uppercase tracking-widest">+ Êñ∞Â¢ûË°åÁ®ãÈ†ÖÁõÆ</button>
                </div>
            </div>

            <div v-if="activeTab === 'shopping'" class="space-y-5">
                <div class="bg-gradient-to-br from-rose-50 to-orange-50 p-7 rounded-[2.8rem] border border-white shadow-sm">
                    <div class="flex justify-between items-end mb-4">
                        <div><p class="text-[10px] font-black text-rose-400 uppercase tracking-widest mb-1">Ë≥ºÁâ©ÊîØÂá∫Á∏ΩË®à</p><h2 class="text-3xl font-black text-slate-800">‚Ç© {{ stats.spentShop.toLocaleString() }}</h2></div>
                        <div class="text-right"><p class="text-[10px] font-bold text-slate-300 mb-1">È†êÁÆó‰∏äÈôê</p><input v-model="shopBudgetLimit" type="number" class="bg-transparent text-xl font-black text-orange-400 text-right w-24 outline-none border-b border-orange-100"></div>
                    </div>
                    <div class="h-2 bg-white rounded-full overflow-hidden mb-6"><div class="h-full bg-rose-300 transition-all duration-500" :style="{ width: Math.min((stats.spentShop / shopBudgetLimit) * 100, 100) + '%' }"></div></div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white/40 p-3 rounded-2xl border border-white"><p class="text-[9px] font-black text-rose-300 mb-1">ÊÉ† ÂÄã‰∫∫</p><p class="text-sm font-bold">‚Ç©{{ stats.huiSelf.toLocaleString() }}</p></div>
                        <div class="bg-white/40 p-3 rounded-2xl border border-white"><p class="text-[9px] font-black text-blue-300 mb-1">Âá° ÂÄã‰∫∫</p><p class="text-sm font-bold">‚Ç©{{ stats.fanSelf.toLocaleString() }}</p></div>
                    </div>
                </div>

                <div v-for="s in shopping" :key="s.id" class="bg-white p-4 rounded-[2.2rem] flex items-center gap-4 border border-slate-50 shadow-sm" :class="{'opacity-50 grayscale': s.bought}">
                    <div class="w-16 h-16 rounded-2xl bg-slate-100 flex items-center justify-center shrink-0 border border-slate-200 overflow-hidden relative">
                        <img v-if="s.photo" :src="s.photo" class="w-full h-full object-cover">
                        <i v-else data-lucide="camera" class="text-slate-300 w-6 h-6"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-black text-slate-800 text-sm truncate">{{ s.name }}</p>
                        <div class="flex items-center gap-2 mt-1">
                            <span class="text-[11px] font-black text-orange-400">‚Ç©{{ s.price.toLocaleString() }}</span>
                            <span :class="['text-[8px] font-black px-1.5 py-0.5 rounded-md', s.owner === 'ÊÉ†' ? 'bg-rose-50 text-rose-400' : 'bg-blue-50 text-blue-400']">{{ s.owner }}</span>
                        </div>
                    </div>
                    <button @click="s.bought = !s.bought" :class="['w-9 h-9 rounded-xl border-2 flex items-center justify-center transition-all', s.bought ? 'bg-emerald-400 border-emerald-400 text-white' : 'border-slate-100 text-transparent']"><i data-lucide="check" class="w-4 h-4"></i></button>
                    <button @click="deleteItem('shopping', s.id)" class="text-slate-200 p-2"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                </div>
                <button @click="openAddModal('shopping')" class="w-full py-5 bg-white border-2 border-dashed border-rose-100 rounded-[2.2rem] text-rose-200 font-black text-xs uppercase tracking-widest">+ Êñ∞Â¢ûË≥ºÁâ©È†ÖÁõÆ</button>
            </div>

            <div v-if="activeTab === 'budget'" class="space-y-5">
                <div class="bg-white p-8 rounded-[3rem] border border-slate-100 shadow-sm text-center">
                    <p class="text-[10px] font-black text-slate-300 uppercase mb-3">ÂÖ±ÂêåÈñãÈä∑Á∏ΩË¶Ω</p>
                    <h2 class="text-4xl font-black text-slate-800">‚Ç© {{ stats.totalExp.toLocaleString() }}</h2>
                    <div class="grid grid-cols-2 gap-6 mt-8 pt-6 border-t border-slate-50">
                        <div class="space-y-1"><p class="text-[10px] font-black text-rose-300">ÊÉ† ÂÖà‰ªò</p><p class="text-base font-black">‚Ç©{{ stats.huiPay.toLocaleString() }}</p></div>
                        <div class="space-y-1"><p class="text-[10px] font-black text-blue-300">Âá° ÂÖà‰ªò</p><p class="text-base font-black">‚Ç©{{ stats.fanPay.toLocaleString() }}</p></div>
                    </div>
                </div>
                <div v-for="b in budget" :key="b.id" class="bg-white p-4.5 rounded-[1.8rem] flex justify-between items-center border border-slate-50">
                    <div class="flex items-center gap-3">
                        <span :class="['w-9 h-9 rounded-2xl flex items-center justify-center text-[10px] font-black', b.payer==='ÊÉ†' ? 'bg-rose-50 text-rose-400' : 'bg-blue-50 text-blue-400']">{{b.payer}}</span>
                        <span class="font-black text-slate-700 text-sm">{{b.n}}</span>
                    </div>
                    <div class="flex items-center gap-4"><p class="text-sm font-black">‚Ç©{{b.p.toLocaleString()}}</p><button @click="deleteItem('budget', b.id)" class="text-slate-200"><i data-lucide="x" class="w-[18px]"></i></button></div>
                </div>
                <button @click="openAddModal('budget')" class="w-full py-5 bg-slate-800 text-white rounded-[2.2rem] font-black shadow-lg text-xs tracking-widest mt-4">+ Ë®òÈåÑÂÖ¨Á©çÈáëÊîØÂá∫</button>
            </div>

            <div v-if="activeTab === 'info'" class="space-y-6">
                <div class="bg-white p-6 rounded-[2.5rem] border border-orange-50 shadow-sm">
                    <p class="text-[11px] font-black text-slate-300 mb-5 flex items-center gap-2 uppercase tracking-widest"><i data-lucide="arrow-right-left" class="w-[14px]"></i> ÂåØÁéáÊèõÁÆó (Á¥Ñ 1:41.6)</p>
                    <div class="flex items-center gap-4">
                        <div class="flex-1 bg-slate-50 rounded-2xl p-4"><p class="text-[9px] font-black text-slate-300 mb-1">KRW ‚Ç©</p><input v-model="calcInput" type="number" class="w-full font-black text-lg bg-transparent outline-none" placeholder="0"></div>
                        <div class="flex-1 bg-orange-50 rounded-2xl p-4 text-orange-600"><p class="text-[9px] font-black opacity-60 mb-1">TWD NT$</p><p class="text-lg font-black">{{ Math.round(calcInput * 0.024).toLocaleString() }}</p></div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-[2.8rem] border border-orange-50 shadow-sm">
                    <div class="flex justify-between items-center mb-5"><h3 class="font-black text-[11px] text-slate-400 uppercase tracking-widest">Âè£Ë¢ãÂêçÂñÆ</h3><button @click="openAddModal('wishlist')" class="p-1.5 bg-orange-50 text-orange-400 rounded-xl"><i data-lucide="plus" class="w-4 h-4"></i></button></div>
                    <div class="space-y-3"><div v-for="w in wishlist" :key="w.id" class="bg-slate-50 p-4 rounded-2xl border border-slate-100 flex justify-between"><div><p class="font-black text-sm text-slate-800">{{w.name}}</p><p class="text-[10px] text-blue-400 mt-1" @click="openGoogleMaps(w.addr)">{{w.addr}}</p></div><button @click="deleteItem('wishlist', w.id)" class="text-slate-200"><i data-lucide="x" class="w-4 h-4"></i></button></div></div>
                </div>
                <div class="bg-blue-50 p-8 rounded-[2.8rem] text-blue-600 border border-blue-100">
                    <h3 class="font-black text-xs mb-3 flex items-center gap-2 uppercase"><i data-lucide="building-2" class="w-4"></i> ‰ΩèÂÆø</h3>
                    <p class="text-xl font-black leading-tight">{{hotelInfo.name}}</p>
                    <p class="text-[11px] opacity-70 mt-2">{{hotelInfo.addr}}</p>
                </div>
            </div>
        </div>

        <nav class="fixed bottom-0 left-0 right-0 h-28 bg-white/70 backdrop-blur-xl border-t border-orange-50 flex justify-around items-center px-6 pb-8 z-50">
            <button v-for="t in tabs" :key="t.id" @click="activeTab = t.id" :class="['flex flex-col items-center gap-1.5 transition-all', activeTab === t.id ? 'text-orange-400 scale-105' : 'text-slate-300']">
                <div :class="['p-2.5 rounded-2xl', activeTab === t.id ? 'bg-orange-50' : '']"><i :data-lucide="t.icon" class="w-[22px]"></i></div>
                <span class="text-[10px] font-black uppercase">{{ t.label }}</span>
            </button>
        </nav>

        <div v-if="showAddModal" class="fixed inset-0 z-[100] flex items-end">
            <div class="absolute inset-0 bg-slate-900/20 backdrop-blur-sm" @click="closeModal"></div>
            <div class="relative w-full bg-white rounded-t-[3rem] p-8 pb-14 shadow-2xl animate-in slide-in-from-bottom duration-300">
                <div class="w-12 h-1.5 bg-slate-100 rounded-full mx-auto mb-8"></div>
                
                <div v-if="modalType === 'itinerary'" class="space-y-4">
                    <h2 class="text-center text-lg font-black">{{ editingItem ? 'Á∑®ËºØË°åÁ®ã' : 'Êñ∞Â¢ûË°åÁ®ã' }}</h2>
                    <input v-model="form.title" class="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="Âú∞ÈªûÂêçÁ®±">
                    <div class="flex gap-4">
                        <input v-model="form.time" class="flex-1 p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="ÊôÇÈñì">
                        <input v-model="form.addr" class="flex-[2] p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="Âú∞ÂùÄ">
                    </div>
                    <textarea v-model="form.note" class="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none h-24" placeholder="ÂÇôË®ª (Ë°åÁ®ãÈáçÈªû„ÄÅÂøÖÈªûÈ£üÁâ©...)"></textarea>
                    <button @click="saveData" class="w-full py-5 bg-slate-800 text-white rounded-[2rem] font-black shadow-lg">ÂÑ≤Â≠ò</button>
                </div>

                <div v-if="modalType === 'shopping'" class="space-y-4">
                    <h2 class="text-center text-lg font-black">Êñ∞Â¢ûË≥ºÁâ©È†ÖÁõÆ</h2>
                    <div class="flex gap-4">
                        <div class="w-24 h-24 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200 flex flex-col items-center justify-center relative overflow-hidden shrink-0">
                            <input type="file" @change="handlePhotoUpload" accept="image/*" class="absolute inset-0 opacity-0 z-10">
                            <img v-if="tempPhoto" :src="tempPhoto" class="w-full h-full object-cover">
                            <div v-else class="text-center"><i data-lucide="camera" class="w-6 h-6 mx-auto text-slate-300"></i><p class="text-[8px] text-slate-300 font-black mt-1">‰∏äÂÇ≥ÂúñÁâá</p></div>
                        </div>
                        <div class="flex-1 space-y-4">
                            <input v-model="form.title" class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="ÂìÅÈ†ÖÂêçÁ®±">
                            <input v-model="form.price" type="number" class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="‚Ç© ÂÉπÊ†º">
                        </div>
                    </div>
                    <div class="flex gap-4 mt-2">
                        <button @click="saveShopping('ÊÉ†')" class="flex-1 py-5 bg-rose-400 text-white rounded-[1.8rem] font-black">ÊÉ†</button>
                        <button @click="saveShopping('Âá°')" class="flex-1 py-5 bg-blue-400 text-white rounded-[1.8rem] font-black">Âá°</button>
                    </div>
                </div>

                <div v-if="modalType === 'wishlist' || modalType === 'budget'" class="space-y-4">
                    <input v-model="form.title" class="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="ÂêçÁ®±/È†ÖÁõÆ">
                    <input v-if="modalType==='budget'" v-model="form.price" type="number" class="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="‚Ç© ÈáëÈ°ç">
                    <input v-if="modalType==='wishlist'" v-model="form.addr" class="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none" placeholder="Âú∞ÂùÄ">
                    <div v-if="modalType==='budget'" class="flex gap-4"><button @click="saveBudget('ÊÉ†')" class="flex-1 py-5 bg-rose-400 text-white rounded-[1.8rem] font-black">ÊÉ†</button><button @click="saveBudget('Âá°')" class="flex-1 py-5 bg-blue-400 text-white rounded-[1.8rem] font-black">Âá°</button></div>
                    <button v-else @click="saveData" class="w-full py-5 bg-slate-800 text-white rounded-[2rem] font-black shadow-lg">ÂÑ≤Â≠ò</button>
                </div>
            </div>
        </div>

        <div v-if="driverTarget" class="fixed inset-0 z-[200] bg-white flex flex-col p-10">
            <button @click="driverTarget = null" class="absolute top-16 right-8 p-4 bg-slate-50 rounded-full text-slate-300"><i data-lucide="x" class="w-6 h-6"></i></button>
            <div class="flex-1 flex flex-col items-center justify-center text-center space-y-12">
                <p class="text-orange-400 font-black tracking-widest text-xs uppercase">Destination:</p>
                <h2 class="text-5xl font-black text-slate-900 leading-tight">{{ driverTarget.title }}</h2>
                <div class="p-10 bg-orange-50/30 rounded-[3.5rem] w-full border border-orange-50 shadow-inner"><p class="text-3xl font-bold text-slate-700 leading-relaxed">{{ driverTarget.addr }}</p></div>
                <div class="opacity-10 scale-150"><i data-lucide="car" class="w-12 h-12"></i></div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, nextTick, watch } = Vue;

        createApp({
            setup() {
                const activeTab = ref('itinerary');
                const activeDay = ref(1);
                const showAddModal = ref(false);
                const modalType = ref('');
                const editingItem = ref(null);
                const driverTarget = ref(null);
                const calcInput = ref('');
                const shopBudgetLimit = ref(300000);
                const tempPhoto = ref(null);
                const form = ref({ title: '', time: '', addr: '', price: '', note: '' });

                const load = (key, def) => JSON.parse(localStorage.getItem(key)) || def;
                const itinerary = ref(load('seo-v5-itinerary', [
                    { id: '1-1', day: 1, time: '22:05', title: 'ÊäµÈÅî‰ªÅÂ∑ù T2', addr: 'Ïù∏Ï≤úÍµ≠Ï†úÍ≥µÌï≠ Ï†ú2Ïó¨Í∞ùÌÑ∞ÎØ∏ÎÑê', note: '‰∏ãÊ©üÂæåÊâæ 6015 Ê∑±Â§úÂ∑¥Â£´ÊàñÊ©üÂ†¥Âø´Á∑ö' }
                ]));
                const shopping = ref(load('seo-v5-shopping', []));
                const budget = ref(load('seo-v5-budget', []));
                const wishlist = ref(load('seo-v5-wishlist', []));
                const hotelInfo = ref({ name: 'È¶ñÁàæÊòéÊ¥ûÁõ∏ÈêµÂñúÊôÆÊ®ÇÂêâÈÖíÂ∫ó', addr: 'È¶ñÁàæÁâπÂà•Â∏Ç‰∏≠ÂçÄÂçóÂ§ßÈñÄË∑Ø5Ë°ó 15', tel: '+82 2-2129-5407' });

                watch([itinerary, shopping, budget, wishlist, shopBudgetLimit], () => {
                    localStorage.setItem('seo-v5-itinerary', JSON.stringify(itinerary.value));
                    localStorage.setItem('seo-v5-shopping', JSON.stringify(shopping.value));
                    localStorage.setItem('seo-v5-budget', JSON.stringify(budget.value));
                    localStorage.setItem('seo-v5-wishlist', JSON.stringify(wishlist.value));
                }, { deep: true });

                const stats = computed(() => ({
                    spentShop: shopping.value.filter(s => s.bought).reduce((a, b) => a + Number(b.price || 0), 0),
                    totalExp: budget.value.reduce((a, b) => a + Number(b.p || 0), 0),
                    huiPay: budget.value.filter(b => b.payer === 'ÊÉ†').reduce((a, b) => a + Number(b.p || 0), 0),
                    fanPay: budget.value.filter(b => b.payer === 'Âá°').reduce((a, b) => a + Number(b.p || 0), 0),
                    huiSelf: shopping.value.filter(s => s.owner === 'ÊÉ†').reduce((a, b) => a + Number(b.price || 0), 0),
                    fanSelf: shopping.value.filter(s => s.owner === 'Âá°').reduce((a, b) => a + Number(b.price || 0), 0)
                }));

                const filteredItinerary = computed(() => itinerary.value.filter(i => Number(i.day) === activeDay.value));
                const getDayDetail = (dayNum) => {
                    const d = new Date('2026-05-16'); d.setDate(d.getDate() + (dayNum - 1));
                    return { date: `${d.getMonth()+1}/${d.getDate()}`, week: `ÈÄ±${['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠'][d.getDay()]}` };
                };

                const moveItem = (id, direction) => {
                    const dayItems = [...filteredItinerary.value]; const index = dayItems.findIndex(i => i.id === id);
                    if ((direction === 'up' && index === 0) || (direction === 'down' && index === dayItems.length - 1)) return;
                    const targetIdx = direction === 'up' ? index - 1 : index + 1;
                    [dayItems[index], dayItems[targetIdx]] = [dayItems[targetIdx], dayItems[index]];
                    const otherItems = itinerary.value.filter(i => Number(i.day) !== activeDay.value);
                    itinerary.value = [...otherItems, ...dayItems];
                };

                const handlePhotoUpload = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (f) => { tempPhoto.value = f.target.result; };
                    reader.readAsDataURL(file);
                };

                const openAddModal = (type) => {
                    modalType.value = type; editingItem.value = null; tempPhoto.value = null;
                    form.value = { title: '', time: '', addr: '', price: '', note: '' };
                    showAddModal.value = true;
                };

                const openEdit = (item) => {
                    modalType.value = 'itinerary'; editingItem.value = item;
                    form.value = { title: item.title, time: item.time, addr: item.addr, note: item.note || '' };
                    showAddModal.value = true;
                };

                const saveData = () => {
                    if (modalType.value === 'itinerary') {
                        if (editingItem.value) {
                            const idx = itinerary.value.findIndex(i => i.id === editingItem.value.id);
                            itinerary.value[idx] = { ...itinerary.value[idx], ...form.value };
                        } else {
                            itinerary.value.push({ id: Date.now().toString(), day: activeDay.value, ...form.value });
                        }
                    } else if (modalType.value === 'wishlist') {
                        wishlist.value.push({ id: Date.now().toString(), name: form.value.title, addr: form.value.addr });
                    }
                    closeModal();
                };

                const saveShopping = (owner) => {
                    shopping.value.push({ id: Date.now().toString(), name: form.value.title, price: form.value.price, owner, bought: false, photo: tempPhoto.value });
                    closeModal();
                };

                const saveBudget = (payer) => {
                    budget.value.push({ id: Date.now().toString(), n: form.value.title, p: form.value.price, payer });
                    closeModal();
                };

                const deleteItem = (type, id) => {
                    if (type === 'shopping') shopping.value = shopping.value.filter(i => i.id !== id);
                    if (type === 'budget') budget.value = budget.value.filter(i => i.id !== id);
                    if (type === 'wishlist') wishlist.value = wishlist.value.filter(i => i.id !== id);
                };

                const closeModal = () => { showAddModal.value = false; };
                const openGoogleMaps = (a) => window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(a)}&travelmode=transit`, '_blank');
                const tabs = [{id:'itinerary',icon:'map',label:'Ë°åÁ®ã'},{id:'shopping',icon:'shopping-bag',label:'Ë≥ºÁâ©'},{id:'budget',icon:'wallet',label:'Ë®òÂ∏≥'},{id:'info',icon:'info',label:'Â∑•ÂÖ∑'}];

                onMounted(() => lucide.createIcons());
                watch([activeTab, activeDay, showAddModal, driverTarget], () => nextTick(() => lucide.createIcons()));

                return {
                    activeTab, activeDay, tabs, itinerary, filteredItinerary, shopping, budget, wishlist, hotelInfo,
                    stats, shopBudgetLimit, calcInput, showAddModal, modalType, editingItem, form, driverTarget, tempPhoto,
                    getDayDetail, openAddModal, openEdit, saveData, saveShopping, saveBudget, deleteItem, moveItem, openGoogleMaps, closeModal, handlePhotoUpload
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
